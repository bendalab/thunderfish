<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>thunderfish.consistentfishes API documentation</title>
<meta name="description" content="Compare fishlists created by the harmonics module in order to create a fishlist with
fishes present in all fishlists â€¦">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>thunderfish.consistentfishes</code></h1>
</header>
<section id="section-intro">
<p>Compare fishlists created by the harmonics module in order to create a fishlist with
fishes present in all fishlists.</p>
<ul>
<li><code><a title="thunderfish.consistentfishes.consistent_fishes" href="#thunderfish.consistentfishes.consistent_fishes">consistent_fishes()</a></code>: Compares a list of fishlists and builds a consistent fishlist.</li>
<li><code><a title="thunderfish.consistentfishes.plot_consistent_fishes" href="#thunderfish.consistentfishes.plot_consistent_fishes">plot_consistent_fishes()</a></code>: Visualize the algorithm of consisten_fishes().</li>
</ul>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="thunderfish.consistentfishes.find_consistency"><code class="name flex">
<span>def <span class="ident">find_consistency</span></span>(<span>fundamentals, df_th=1.0)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def find_consistency(fundamentals, df_th=1.0):
    &#34;&#34;&#34;
    Compares lists of floats to find these values consistent in every list.
    (with a certain threshold)

    Every value of the first list is compared to the values of the other
    lists. The consistency_help array consists in the beginning of ones,
    has the same length as the first list and is used to keep the
    information about values that are available in several lists. If the
    difference between a value of the first list and a value of another
    list is below the threshold the entry of the consistency_help array
    is added 1 to at the index of the value in the value in the first
    list. The indices of the consistency_help array that are equal to
    the amount of lists compared are the indices of the values of the
    first list that are consistent in all lists. The consistent value
    array and the indices are returned.


    Parameters
    ----------
    fundamentals: 2-D array
        List of lists containing the fundamentals of a fishlist.
        fundamentals = [ [f1, f1, ..., f1, f1], [f2, f2, ..., f2, f2], ..., [fn, fn, ..., fn, fn] ]
    df_th: float
        Frequency threshold for the comparison of different fishlists in Hertz. If the fundamental
        frequencies of two fishes from different fishlists vary less than this threshold they are
        assigned as the same fish.

    Returns
    -------
    consistent_fundamentals: 1-D array
        List containing all values that are available in all given lists.
    index: 1-D array
        Indices of the values that are in every list relating to the fist list in fishlists.
    &#34;&#34;&#34;
    consistency_help = np.ones(len(fundamentals[0]), dtype=int)

    for enu, fundamental in enumerate(fundamentals[0]):
        for list in range(1, len(fundamentals)):
            if np.sum(np.abs(fundamentals[list] - fundamental) &lt; df_th) &gt; 0:
                consistency_help[enu] += 1

    index = np.arange(len(fundamentals[0]))[consistency_help == len(fundamentals)]
    consistent_fundamentals = fundamentals[0][index]

    return consistent_fundamentals, index</code></pre>
</details>
<div class="desc"><p>Compares lists of floats to find these values consistent in every list.
(with a certain threshold)</p>
<p>Every value of the first list is compared to the values of the other
lists. The consistency_help array consists in the beginning of ones,
has the same length as the first list and is used to keep the
information about values that are available in several lists. If the
difference between a value of the first list and a value of another
list is below the threshold the entry of the consistency_help array
is added 1 to at the index of the value in the value in the first
list. The indices of the consistency_help array that are equal to
the amount of lists compared are the indices of the values of the
first list that are consistent in all lists. The consistent value
array and the indices are returned.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>fundamentals</code></strong> :&ensp;<code>2-D array</code></dt>
<dd>List of lists containing the fundamentals of a fishlist.
fundamentals = [ [f1, f1, &hellip;, f1, f1], [f2, f2, &hellip;, f2, f2], &hellip;, [fn, fn, &hellip;, fn, fn] ]</dd>
<dt><strong><code>df_th</code></strong> :&ensp;<code>float</code></dt>
<dd>Frequency threshold for the comparison of different fishlists in Hertz. If the fundamental
frequencies of two fishes from different fishlists vary less than this threshold they are
assigned as the same fish.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>consistent_fundamentals</code></strong> :&ensp;<code>1-D array</code></dt>
<dd>List containing all values that are available in all given lists.</dd>
<dt><strong><code>index</code></strong> :&ensp;<code>1-D array</code></dt>
<dd>Indices of the values that are in every list relating to the fist list in fishlists.</dd>
</dl></div>
</dd>
<dt id="thunderfish.consistentfishes.consistent_fishes"><code class="name flex">
<span>def <span class="ident">consistent_fishes</span></span>(<span>fishlists, verbose=0, plot_data_func=None, df_th=1.0, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def consistent_fishes(fishlists, verbose=0, plot_data_func=None, df_th=1.0, **kwargs):
    &#34;&#34;&#34;
    Compares several fishlists to create a fishlist only containing these fishes present in all these fishlists.

    Therefore several functions are used to first extract the fundamental frequencies of every fish in each fishlist,
    before comparing them and building a fishlist only containing these fishes present in all fishlists.

    Parameters
    ----------
    fishlists: list of list of 2D array
        List of fishlists with harmonics and each frequency and power.
        fishlists[fishlist][fish][harmonic][frequency, power]
    plot_data_func:
        Function that visualizes what consistent_fishes() did.
    verbose: int
        When the value larger than one you get additional shell output.
    df_th: float
        Frequency threshold for the comparison of different fishlists in Hertz. If the fundamental
        frequencies of two fishes from different fishlists vary less than this threshold they are
        assigned as the same fish.
    **kwargs: dict
        Passed on to plot function.

    Returns
    -------
    filtered_fishlist: list of 2-D arrays
        New fishlist with the same structure as a fishlist in fishlists only
        containing these fishes that are available in every fishlist in fishlists.
        fishlist[fish][harmonic][frequency, power]
    &#34;&#34;&#34;
    if verbose &gt;= 1:
        print(&#39;Finding consistent fishes out of %d fishlists ...&#39; % len(fishlists))

    fundamentals = fundamental_freqs(fishlists)
    if len(fundamentals) == 0:
        return []

    consistent_fundamentals, index = find_consistency(fundamentals)

    # creates a filtered fishlist only containing the data of the fishes consistent in several fishlists.
    filtered_fishlist = []
    for idx in index:
        filtered_fishlist.append(fishlists[0][idx])

    if plot_data_func:
        plot_data_func(fishlists, filtered_fishlist, **kwargs)

    return filtered_fishlist</code></pre>
</details>
<div class="desc"><p>Compares several fishlists to create a fishlist only containing these fishes present in all these fishlists.</p>
<p>Therefore several functions are used to first extract the fundamental frequencies of every fish in each fishlist,
before comparing them and building a fishlist only containing these fishes present in all fishlists.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>fishlists</code></strong> :&ensp;<code>list</code> of <code>list</code> of <code>2D array</code></dt>
<dd>List of fishlists with harmonics and each frequency and power.
fishlists[fishlist][fish][harmonic][frequency, power]</dd>
<dt>plot_data_func:</dt>
<dt>Function that visualizes what consistent_fishes() did.</dt>
<dt><strong><code>verbose</code></strong> :&ensp;<code>int</code></dt>
<dd>When the value larger than one you get additional shell output.</dd>
<dt><strong><code>df_th</code></strong> :&ensp;<code>float</code></dt>
<dd>Frequency threshold for the comparison of different fishlists in Hertz. If the fundamental
frequencies of two fishes from different fishlists vary less than this threshold they are
assigned as the same fish.</dd>
<dt><strong><code>**kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>Passed on to plot function.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>filtered_fishlist</code></strong> :&ensp;<code>list</code> of <code>2-D arrays</code></dt>
<dd>New fishlist with the same structure as a fishlist in fishlists only
containing these fishes that are available in every fishlist in fishlists.
fishlist[fish][harmonic][frequency, power]</dd>
</dl></div>
</dd>
<dt id="thunderfish.consistentfishes.plot_consistent_fishes"><code class="name flex">
<span>def <span class="ident">plot_consistent_fishes</span></span>(<span>fishlists, filtered_fishlist, ax, fs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_consistent_fishes(fishlists, filtered_fishlist, ax, fs):
    &#34;&#34;&#34;
    Creates an axis for plotting all lists and the consistent values marked with a bar.

    Parameters
    ----------
    filtered_fishlist: 3-D array
        Contains power and frequency of these fishes that hve been detected in
        several powerspectra using different resolutions.
    fishlists: 4-D array or 3-D array
        List of or single fishlists with harmonics and each frequency and power.
        fishlists[fishlist][fish][harmonic][frequency, power]
        fishlists[fish][harmonic][frequency, power]
    ax: axis for plot
        Empty axis that is filled with content in the function.
    fs: int
        Fontsize for the plot.
    &#34;&#34;&#34;
    for list in np.arange(len(fishlists)):
        for fish in np.arange(len(fishlists[list])):
            ax.plot(list + 1, fishlists[list][fish][0][0], &#39;k.&#39;, markersize=10)

    for fish in np.arange(len(filtered_fishlist)):
        x = np.arange(len(fishlists)) + 1
        y = [filtered_fishlist[fish][0][0] for i in range(len(fishlists))]
        if fish == 0:
            ax.plot(x, y, &#39;-r&#39;, linewidth=10, alpha=0.5, label=&#39;consistent in all lists&#39;)
        else:
            ax.plot(x, y, &#39;-r&#39;, linewidth=10, alpha=0.5)
    ax.set_xlim([0, len(fishlists) + 1])
    ax.set_ylabel(&#39;value&#39;, fontsize=fs)
    ax.set_xlabel(&#39;list no.&#39;, fontsize=fs)</code></pre>
</details>
<div class="desc"><p>Creates an axis for plotting all lists and the consistent values marked with a bar.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>filtered_fishlist</code></strong> :&ensp;<code>3-D array</code></dt>
<dd>Contains power and frequency of these fishes that hve been detected in
several powerspectra using different resolutions.</dd>
<dt><strong><code>fishlists</code></strong> :&ensp;<code>4-D array</code> or <code>3-D array</code></dt>
<dd>List of or single fishlists with harmonics and each frequency and power.
fishlists[fishlist][fish][harmonic][frequency, power]
fishlists[fish][harmonic][frequency, power]</dd>
<dt><strong><code>ax</code></strong> :&ensp;<code>axis for plot</code></dt>
<dd>Empty axis that is filled with content in the function.</dd>
<dt><strong><code>fs</code></strong> :&ensp;<code>int</code></dt>
<dd>Fontsize for the plot.</dd>
</dl></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="thunderfish" href="index.html">thunderfish</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="thunderfish.consistentfishes.find_consistency" href="#thunderfish.consistentfishes.find_consistency">find_consistency</a></code></li>
<li><code><a title="thunderfish.consistentfishes.consistent_fishes" href="#thunderfish.consistentfishes.consistent_fishes">consistent_fishes</a></code></li>
<li><code><a title="thunderfish.consistentfishes.plot_consistent_fishes" href="#thunderfish.consistentfishes.plot_consistent_fishes">plot_consistent_fishes</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
